/*! trade */
define(["jquery","Keeper","base64"],function(a,b,c){b("scrolltoolbar",{tpl:{t1:function(){var a=new b.Buffers;return/\/my\/orders/.test(window.location.pathname)?(a.append('<aside class="sidepanel_new">'),a.append('<div class="new_list"><h3 class="tit"><i class="g_pic"></i><span class="colse"></span>常见问题</h3><ul></ul></div>'),a.append("</aside>")):(a.append('<aside class="sidepanel">'),a.append('	<ul class="list">'),a.append('		<li class="i1" style="display:block;"><a class="js_questionspub" href="http://help.zhe800.com/" target="_blank">常见问题</a></li>'),a.append('		<li class="i2"><a class="feedback_popup_handler" href="javascript:" >用户反馈</a></li>'),a.append('		<li class="i3"><a href="http://wpa.b.qq.com/cgi/wpa.php?ln=1&amp;key=XzgwMDA2MTAyNV8xMzQ3NDhfODAwMDYxMDI1XzJf" class="contractKf diacontractKf" target="_blank">在线客服</a></li>'),a.append('		<li class="i4 hidden"><a class="js_gotoppub" href="#" target="_blank">返回顶部</a></li>'),a.append("    </ul>"),a.append("</aside>")),a.toString()}},init:function(){var b=this;a("body").append(b.tpl.t1()),/\/my\/orders/.test(window.location.pathname)?b.cfinit_screen():(b.cfinit(),b.feedinit())},cfinit_screen:function(){function b(){a(".sidepanel_new").css("top",d)}var c=this,d=a("#head_nav").offset().top+a("#head_nav").height()+17;b(),c.new_cfinit(),a(window).width()<=1352?a(".sidepanel_new").addClass("sidepanel_w_sco"):[],a(window).resize(function(){a(this).width()<=1352?a(".sidepanel_new").addClass("sidepanel_w_sco"):a(".sidepanel_new").removeClass("sidepanel_w_sco")}),a(window).scrollTop()>d?[a(".sidepanel_new").addClass("sidepanel_sco"),a(".sidepanel_new").css("top","17px")]:[],a(".new_list").offset().top+a(".new_list").height()+20>a(".about").offset().top?a(".new_list").hide():a(".new_list").show(),a(window).bind("scroll",function(){a(window).scrollTop()>d&&(a(".sidepanel_new").css("top","17px"),a(".sidepanel_new").addClass("sidepanel_sco")),a(window).scrollTop()<d&&(b(),a(".sidepanel_new").removeClass("sidepanel_sco")),a(".new_list").offset().top+a(".new_list").height()+20>a(".about").offset().top?a(".new_list").hide():a(".new_list").show()}),a(".sidepanel_new .colse").bind("click",function(b){a(".sidepanel_new").remove()})},cfinit:function(c,d){a(".js_questionspub").bind("click",function(){var c=a(this);if(a(".js_questionsbox").length>0)return a(".js_questionsbox").removeClass("hidden"),c.parent().addClass("on"),!1;if(!("clicks"!=c.data("clicks")&&a("#right_faq").length>0&&""!=a("#right_faq").attr("href")))return!0;c.data("clicks","clicks");var d=a("#right_faq").attr("href");return a.getJSON(d,function(d){if(200==d.status){var e=""==d.more_url||"#"==d.more_url?"http://help.zhe800.com/":d.more_url;if(d.data.length>0){var f=new b.Buffers;return f.append('<div class="tips js_questionsbox">'),f.append('	<div class="close"><a title="关闭窗口" href="javascript:void(0)"></a></div>'),f.append('	<div class="list12">'),f.append("		<sup></sup><h4>常见问题：</h4>"),f.append("		<ul>"),a.each(d.data,function(a,b){f.append('		<li><a href="'+b.url+'" target="_blank">'+b.title+"</a></li>")}),f.append('			<li class="last"><a href="'+e+'" target="_blank">其他问题&gt;&gt;</a></li>'),f.append("		</ul>"),f.append("	</div>"),f.append("</div>"),a("aside.sidepanel").append(f.toString()),a(".js_questionsbox .close").bind("click",function(){a(".js_questionsbox").addClass("hidden"),c.parent().removeClass("on")}),c.parent().addClass("on"),!1}}var f=new b.Buffers;return f.append('<div class="tips js_questionsbox">'),f.append('	<div class="close"><a title="关闭窗口" href="javascript:void(0)"></a></div>'),f.append('	<div class="list12">'),f.append("		<sup></sup><h4>常见问题：</h4>"),f.append("		<ul>"),f.append('			<li>亲，您有疑问可以咨询<a style="color:#428bca" class="diacontractKf" href="http://wpa.b.qq.com/cgi/wpa.php?ln=1&key=XzgwMDA2MTAyNV8xMzQ3NDhfODAwMDYxMDI1XzJf" target="_blank">【折800客服】</a> 或 去<a style="color:#428bca" href="http://help.zhe800.com/" target="_blank">【帮助中心】</a>看看吧^_^</li>'),f.append("		</ul>"),f.append("	</div>"),f.append("</div>"),a("aside.sidepanel").append(f.toString()),a(".js_questionsbox .close").bind("click",function(){a(".js_questionsbox").addClass("hidden"),c.parent().removeClass("on")}),c.parent().addClass("on"),!1}),!1}),a(".js_gotoppub").bind("click",function(){return a("body,html").animate({scrollTop:0},500),!1});var e=a(".js_gotoppub").parent();a(window).scroll(function(){a(this).scrollTop()>0?e.removeClass("hidden"):e.addClass("hidden")});var f=a(".five_twocode").parent();a(window).scroll(function(){viewH=a(document).height(),a(".sidepanel .list .i1").offset().top+750>=viewH?f.addClass("hidden"):f.removeClass("hidden")});Keeper.login()?Keeper.login():{uid:0}},new_cfinit:function(){var c=a("#right_faq").attr("href");a.getJSON(c,function(c){if(c&&c.data&&200==c.status){var d=new b.Buffers,e=""==c.more_url||"#"==c.more_url?"http://help.zhe800.com/":c.more_url,f=0;f=c.data.length>4?4:c.data.length;for(var g=0;f>g;g++)d.append('<li><span>•</span><p><a target="_blank" href="'+c.data[g].url+'">'+c.data[g].title+"</a></p></li>");d.append('<li class="more"><a target="_blank" href="'+e+'">其他问题>></a></li>'),a("aside.sidepanel_new .new_list ul").append(d.toString())}})},feedinit:function(){var c=this;a("body").on("click",".feedback_popup_handler",function(d){var e=a(this),f=new b.Buffers,g="请输入您的意见或者建议（必填）",h="QQ或者邮箱（必填）";f.append("<h4>意见反馈</h4>"),f.append("<ul>"),f.append('    <li class="hd"><p>折800真诚欢迎您的反馈，以更好的为您服务！</p></li>'),f.append('    <li class=""><span>反馈类型</span>'),f.append('        <select><option value="-1" selected="true">请选择</option><option value="0">意见建议</option><option value="2">投诉</option><option value="1">售后问题</option><option  value="3">账号/积分/页面异常</option><option  value="4">商品详情咨询</option><option  value="5">折800报名</option><option  value="6">商务合作</option></select>'),f.append("    </li>"),f.append('    <li class="exch_cont txt"><textarea class="gint">'+g+"</textarea></li>"),f.append('    <li class="exch_cont tip_normal"><p>为了方便我们进一步跟您联系，请填写如下信息</p></li>'),f.append('    <li class="exch_cont inp"><span><i>*</i>&nbsp;<input type="text" class="gint qqinp" value="'+h+'" /></span></li>'),f.append('    <li class="exch_cont tip_emergency"><p>如事情紧急，可咨询<a class="diacontractKf" href="http://wpa.b.qq.com/cgi/wpa.php?ln=1&key=XzgwMDA2MTAyNV8xMzQ3NDhfODAwMDYxMDI1XzJf" target="_blank">在线客服 &gt;&gt;</a></p></li>'),f.append('    <li class="exch_cont tip_consult"><p>请咨询<a class="diacontractKf" href="http://wpa.b.qq.com/cgi/wpa.php?ln=1&key=XzgwMDA2MTAyNV8xMzQ3NDhfODAwMDYxMDI1XzJf" target="_blank">在线客服 &gt;&gt;</a></p></li>'),f.append('    <li class="exch_cont tip_consultin"><p>请您在商品详情页咨询<span>卖家在线客服</span>（例如下图）</p></li>'),f.append('    <li class="exch_cont tip_consultin_img"><div></div></li>'),f.append('    <li class="exch_cont tip_sign"><p>报名折800活动请到<a href="https://zhaoshang.zhe800.com/" target="_blank">卖家中心&gt;&gt;</a></p></li>'),f.append('    <li class="exch_cont tip_business"><p>请将您的<span>姓名</span>、<span>联系方式</span>、<span>公司名称</span>以及<span>合作方式</span>编辑邮件至<a href="mailto:contact@tuan800.com"><span>contact@tuan800.com</span></a>邮箱，会有相关人员与您进行联系。</p></li>'),f.append('    <li class="token hidden"><strong>验证码：</strong><input type="text" class="gint" autocomplete="off" name="captcha"> <img class="captchaImg" src=""> <a href="#">换一换</a></li>'),f.append("</ul>"),f.append('<div class="submit">'),f.append('    <i class="i_btn i_btn1"><a href="javascript:void(0);">确认提交</a></i>'),f.append("</div>"),e.parent().addClass("on"),a.Dialogs({overlay:!1,cls:"feedbackpanel closeblock",auto:!1,msg:f.toString(),closefun:function(){e.parent().removeClass("on")},openfun:function(){a(".feedbackpanel textarea").bind({focus:function(){a(this).val()==g&&a(this).val(""),a(".feedbackpanel .token").hasClass("hidden")&&(c.getVericode(),a(".feedbackpanel .token").removeClass("hidden"))},blur:function(){""==a(this).val()&&a(this).val(g)}}),a(".feedbackpanel .qqinp").bind({focus:function(){a(this).val()==h&&a(this).val(""),a(".feedbackpanel .token").hasClass("hidden")&&(c.getVericode(),a(".feedbackpanel .token").removeClass("hidden"))},blur:function(){""==a(this).val()&&a(this).val(h)}}),a(".feedbackpanel .token a").click(function(){return c.getVericode(),!1}),a(".feedbackpanel .submit .i_btn1").click(function(){c.formart(g,h)}),a(".feedbackpanel select").change(function(){var b=a(this).parents("ul"),c=a(this).val();switch(b.find("li.exch_cont").hide(),b.next("div.submit").hide(),b.find("li.erroe").remove(),c){case"-1":b.next("div.submit").hide(),b.find("li.token").addClass("hidden");break;case"0":g="请输入您的意见或者建议（必填）",h="手机号码（必填）",b.find("li.txt textarea").val(g),b.find("li.inp input").val(h),b.find("li.txt").show(),b.find("li.tip_normal").show(),b.find("li.inp").show(),b.next("div.submit").show();break;case"2":g="请输入您的投诉事件（必填）",h="手机号码（必填）",b.find("li.txt textarea").val(g),b.find("li.inp input").val(h),b.find("li.txt").show(),b.find("li.tip_normal").show(),b.find("li.inp").show(),b.find("li.tip_emergency").show(),b.next("div.submit").show();break;case"1":b.find("li.tip_consult").show(),b.find("li.token").addClass("hidden");break;case"3":b.find("li.tip_consult").show(),b.find("li.token").addClass("hidden");break;case"4":b.find("li.tip_consultin").show(),b.find("li.tip_consultin_img").show(),b.find("li.token").addClass("hidden");break;case"5":b.find("li.tip_sign").show(),b.find("li.token").addClass("hidden");break;case"6":b.find("li.tip_business").show(),b.find("li.token").addClass("hidden")}})}});var i=a(".diacontractKf");return Keeper.cookie("ppinf")?i.length>0&&a.each(i,function(b,c){var d=a(this);d.after('<p class="contractKf_imp" style="display:inline"></p>'),IMinit(d.next(".contractKf_imp")[0],{type:"service"}),d.remove()}):a.each(i,function(c,d){a(d).click(function(){return b("dialogPP").init({id:"dialog_log_qiandao",cls:"dialog_log_qiandao",appid:3112}),!1})}),d.preventDefault(),!1})},formart:function(b,c){var d=a(".feedbackpanel select").val();a(".feedbackpanel ul .erroe").remove();var e=this,f=a(".feedbackpanel ul").append('<li class="erroe" />').find(".erroe").css("color","#e20000"),g=/^1{1}\d{10}/gi;if(0==d){if(""==a(".feedbackpanel textarea").val()||a(".feedbackpanel textarea").val()==b)return f.html("请填写意见或者建议"),!1;if(""==a(".feedbackpanel .qqinp").val()||a(".feedbackpanel .qqinp").val()==c)return f.html("请填写手机号码"),!1;if(""!=a(".feedbackpanel .qqinp").val()&&!g.test(a(".feedbackpanel .qqinp").val()))return f.html("请输入正确的手机号码"),!1}else if(2==d){if(""==a(".feedbackpanel textarea").val()||a(".feedbackpanel textarea").val()==b)return f.html("请填写投诉信息"),!1;if(""==a(".feedbackpanel .qqinp").val()||a(".feedbackpanel .qqinp").val()==c)return f.html("请填写手机号码"),!1;if(!g.test(a(".feedbackpanel .qqinp").val()))return f.html("手机号码输入不正确"),!1}return""==a(".feedbackpanel .token input").val()?(f.html("请输入验证码"),!1):void a.post("/remit/feedback",{"feedback[type]":a(".feedbackpanel select").val(),"feedback[content]":a(".feedbackpanel textarea").val(),"feedback[contact]":a(".feedbackpanel .qqinp").val(),captcha:a(".feedbackpanel .token input").val()},function(b){a(".feedbackpanel").css("minHeight",0),0==b.status?(a(".feedbackpanel .diginfo ul").html('<li class="suc"><p><i class="gfail1"></i>提交成功！</p>亲，感谢您提供的宝贵意见！</li>'),a(".feedbackpanel .submit .i_btn1").html('<a href="javascript:void(0);">关闭</a>').unbind().click(function(){a(".feedbackpanel .close").trigger("click")})):(b.messages.contact&&f.html(b.messages.contact),b.messages.qq&&f.html(b.messages.qq),b.messages.email&&f.html(b.messages.email),b.messages.content&&f.html(b.messages.content),b.messages.captcha&&f.html(b.messages.captcha),e.getVericode())})},getVericode:function(){a.post("/cn/captcha",function(b){0==b.status&&a(".feedbackpanel .token img").attr("src",b.url)})}})});